cat("Problem Set 4","\n")
cat("Ben Reichert\n\n")

### 1 ###
n1 = 50000
# a)
ex1 = n1 * 0.02
varx1 = ((n1 - ex1)^2) * 0.02
sdx1 = sqrt(varx1)
# b)
ey1 = n1 * 0.4 * 0.02
vary1 = ((n1 - ey1)^2) * 0.02*0.4
sdy1 = sqrt(vary1)
# c)
c1 = 0
for (i in 0:419) {
  c1 = c1 + dbinom(i, n1, 0.4*0.02)
}
c1 = 1 - c1

cat("1. \n", "a.) EX =",ex1,", STDEV(X) =",sdx1,"\n b.) EY =",ey1,", STDEV(Y) =",sdy1,
    "\n c.) P(X ≥ 420) =",c1,"= 16.37%\n\n")

### 2 ###
# a)
e2 = (1/4)*25
# b)
p2 = 0
for (i in 0:7) {
  p2 = p2 + dbinom(i, 25, 0.25)
}
p2 = 1-p2
# c)
p2c = 1 - dbinom(0, 20, p2)

cat("2. 14.5.14 \n", "a.) EX =",e2,"\n b.) P(X > 7) =",p2,"= 27.35%\n","c.) P(X > 0) =",p2c,
    "= 99.83%\n\n")

### 3 ###
# a)
a3 = "f is a PDF because 1/20 and 0 are both always non negative and there are 20 values
    in 20 ≤ x < 40, each at 1/20 and 20 * (1/20) is"
a33 = 20 * (1/20)
# b)
cdf3 = "CDF F(x):
       0 - x < 20
    0.05 - 20 ≤ x < 21
    0.10 - 21 ≤ x < 22
    0.15 - 22 ≤ x < 23
    0.20 - 23 ≤ x < 24
    0.25 - 24 ≤ x < 25
    0.30 - 25 ≤ x < 26
    0.35 - 26 ≤ x < 27
    0.40 - 27 ≤ x < 28
    0.45 - 28 ≤ x < 29
    0.50 - 29 ≤ x < 30
    0.55 - 30 ≤ x < 31
    0.60 - 31 ≤ x < 32
    0.65 - 32 ≤ x < 33
    0.70 - 33 ≤ x < 34
    0.75 - 34 ≤ x < 35
    0.80 - 35 ≤ x < 36
    0.85 - 36 ≤ x < 37
    0.90 - 37 ≤ x < 38
    0.95 - 38 ≤ x < 39
    1.00 - 39 ≤ x < 40
       0 - x ≥ 40"
# c)
c3 = 0.05 * 10
# d)
e3 = 0
for (i in 20:39) {
  e3 = e3 + i*0.05
}
# e)
vec3 <- c(20,21,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39)
var3=var(vec3)
var3test=0
for(i in 20:39) {
  var3test = var3test + (i-e3)*(i-e3) * 0.05
}
sd3=sqrt(var3test)

cat("3.\n","a.)",a3,a33,".\n b.)",cdf3,"\n c.) P(30 ≤ x < 50) =",c3,"\n d.) Ex =",e3,
    "\n e.) Var(x) =",var3test,", StDev(x) =",sd3,"\n\n")

### 4 ###
# a)
a4a = (1/30) * 21
a4b = (1/60) * 18
# b)
b4 = c(20,19,18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0,19,18,17,16,15,14,13,12,11,
       10,9,8,7,6,5,4,3,2,1,0,39,38,37,36,35,34,33,32,31,30,29,28,27,26,25,24,23,22,21)
b4len = length(b4)

cat("4.\n","a.) P(X ≤ 20) =",a4a,", P(X > 20) =",a4b,"\n b.) EX =",sum(b4)/b4len,"minutes\n\n")

### 5 ###
# a)
a5 = 1-exp(-0.3*2)
# b)
b5 = (1-exp(-0.3*4)) - (1-exp(-0.3*2))
# c)
c5 = 0
for (i in 0:100) {
  c5 = c5 + (i * 0.3*exp(-.3*i))
}
# d)
d5 = exp(-.3*3)

cat("5.\n","a.) P(X < 3) =",a5,"\n b.) P(2 ≤ X < 4) =",b5,"\n c.) EX =",c5,
    "\n d.) P(X ≥ 3)^2 =",d5*d5)